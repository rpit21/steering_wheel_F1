<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F1 Steering Wheel Firmware: ecu_sim Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">F1 Steering Wheel Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ecu_sim Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ada69a128270617ba73db82bd43dfde66" id="r_ada69a128270617ba73db82bd43dfde66"><td class="memItemLeft" align="right" valign="top"><a id="ada69a128270617ba73db82bd43dfde66" name="ada69a128270617ba73db82bd43dfde66"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>db</b> = cantools.database.load_file(&quot;drivers/steering_wheel.dbc&quot;)</td></tr>
<tr class="separator:ada69a128270617ba73db82bd43dfde66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640e22210af862cedc3b402d0dcb1106" id="r_a640e22210af862cedc3b402d0dcb1106"><td class="memItemLeft" align="right" valign="top"><a id="a640e22210af862cedc3b402d0dcb1106" name="a640e22210af862cedc3b402d0dcb1106"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>bus</b> = can.interface.Bus(channel='vcan0', bustype='socketcan')</td></tr>
<tr class="separator:a640e22210af862cedc3b402d0dcb1106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1274ecda39a06d62aded7cdd66ae40" id="r_a4e1274ecda39a06d62aded7cdd66ae40"><td class="memItemLeft" align="right" valign="top"><a id="a4e1274ecda39a06d62aded7cdd66ae40" name="a4e1274ecda39a06d62aded7cdd66ae40"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>gear</b> = 0</td></tr>
<tr class="separator:a4e1274ecda39a06d62aded7cdd66ae40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0899763006551dc684acc15c57a669b" id="r_aa0899763006551dc684acc15c57a669b"><td class="memItemLeft" align="right" valign="top"><a id="aa0899763006551dc684acc15c57a669b" name="aa0899763006551dc684acc15c57a669b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>pit_active</b> = 0</td></tr>
<tr class="separator:aa0899763006551dc684acc15c57a669b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19f0c47203dea67d838efe68b8b41460" id="r_a19f0c47203dea67d838efe68b8b41460"><td class="memItemLeft" align="right" valign="top"><a id="a19f0c47203dea67d838efe68b8b41460" name="a19f0c47203dea67d838efe68b8b41460"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>drs_status</b> = 0</td></tr>
<tr class="separator:a19f0c47203dea67d838efe68b8b41460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04953461b02690cf7e855e89245f62b6" id="r_a04953461b02690cf7e855e89245f62b6"><td class="memItemLeft" align="right" valign="top"><a id="a04953461b02690cf7e855e89245f62b6" name="a04953461b02690cf7e855e89245f62b6"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>prev_buttons</b> = 0</td></tr>
<tr class="separator:a04953461b02690cf7e855e89245f62b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c3563e23297be64fb42073b0be06377" id="r_a4c3563e23297be64fb42073b0be06377"><td class="memItemLeft" align="right" valign="top"><a id="a4c3563e23297be64fb42073b0be06377" name="a4c3563e23297be64fb42073b0be06377"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>msg</b> = bus.recv(0.1)</td></tr>
<tr class="separator:a4c3563e23297be64fb42073b0be06377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ad74428fa256c761415c830a160427e" id="r_a7ad74428fa256c761415c830a160427e"><td class="memItemLeft" align="right" valign="top"><a id="a7ad74428fa256c761415c830a160427e" name="a7ad74428fa256c761415c830a160427e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>data</b> = db.decode_message('SteeringWheel_Status', msg.data)</td></tr>
<tr class="separator:a7ad74428fa256c761415c830a160427e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c5dde11ae716ead405567eae68ebbe" id="r_ad3c5dde11ae716ead405567eae68ebbe"><td class="memItemLeft" align="right" valign="top"><a id="ad3c5dde11ae716ead405567eae68ebbe" name="ad3c5dde11ae716ead405567eae68ebbe"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>buttons</b> = 0</td></tr>
<tr class="separator:ad3c5dde11ae716ead405567eae68ebbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1dafb9d92ddb28c908f31d70baf20a0" id="r_ad1dafb9d92ddb28c908f31d70baf20a0"><td class="memItemLeft" align="right" valign="top"><a id="ad1dafb9d92ddb28c908f31d70baf20a0" name="ad1dafb9d92ddb28c908f31d70baf20a0"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rising_edges</b> = buttons &amp; (~prev_buttons)</td></tr>
<tr class="separator:ad1dafb9d92ddb28c908f31d70baf20a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b16750cbdf6c0e2805216870ef60b79" id="r_a1b16750cbdf6c0e2805216870ef60b79"><td class="memItemLeft" align="right" valign="top"><a id="a1b16750cbdf6c0e2805216870ef60b79" name="a1b16750cbdf6c0e2805216870ef60b79"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ecu_status</b> = db.get_message_by_name('ECU_Status_Display')</td></tr>
<tr class="separator:a1b16750cbdf6c0e2805216870ef60b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0405e2c3b662175296485d4cd8498800" id="r_a0405e2c3b662175296485d4cd8498800"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceecu__sim.html#a0405e2c3b662175296485d4cd8498800">payload</a></td></tr>
<tr class="separator:a0405e2c3b662175296485d4cd8498800"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">@file ecu_sim.py
@brief ECU simulation script for CAN communication testing.

@details
This script emulates the behavior of an Engine Control Unit (ECU) for testing
the Steering Wheel firmware over a virtual CAN interface (`vcan0`).

It performs the following operations in a continuous loop:
1. Listens for incoming messages from the Steering Wheel (ID 0x101).
2. Decodes and prints the received steering data using the DBC file.
3. Periodically transmits an ECU status message (ID 0x201) containing
   simulated temperature values (Temp1, Temp2).

@note
This script requires:
- Python packages: `python-can`, `cantools`
- A virtual CAN interface (`vcan0`) created in the system.
  Example setup:
      sudo modprobe vcan
      sudo ip link add dev vcan0 type vcan
      sudo ip link set up vcan0

@usage
Run this script alongside the Steering Wheel firmware running on PC
(simulated with SocketCAN). The two will exchange CAN frames in real-time.
</pre> </div><h2 class="groupheader">Variable Documentation</h2>
<a id="a0405e2c3b662175296485d4cd8498800" name="a0405e2c3b662175296485d4cd8498800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0405e2c3b662175296485d4cd8498800">&#9670;&#160;</a></span>payload</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ecu_sim.payload</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  ecu_status.encode({</div>
<div class="line"><span class="lineno">    2</span> </div>
<div class="line"><span class="lineno">    3</span>            <span class="stringliteral">&#39;Temp1&#39;</span>: random.uniform(-40, 20),   <span class="comment"># Temperature sensor 1 (°C)</span></div>
<div class="line"><span class="lineno">    4</span>            <span class="stringliteral">&#39;Temp2&#39;</span>: random.uniform(100, 150),    <span class="comment"># Temperature sensor 2 (°C)</span></div>
<div class="line"><span class="lineno">    5</span>            <span class="stringliteral">&quot;PitLimiter_Active&quot;</span>: pit_active,</div>
<div class="line"><span class="lineno">    6</span>            <span class="stringliteral">&quot;DRS_Status&quot;</span>: drs_status,</div>
<div class="line"><span class="lineno">    7</span>            <span class="stringliteral">&quot;LED2_PitLimiter&quot;</span>: pit_active,</div>
<div class="line"><span class="lineno">    8</span>            <span class="stringliteral">&quot;LED1_Temperature&quot;</span>: 1 <span class="keywordflow">if</span> random.random() &gt; 0.7 <span class="keywordflow">else</span> 0,</div>
<div class="line"><span class="lineno">    9</span>            <span class="stringliteral">&quot;Gear_Actual&quot;</span>: gear,</div>
<div class="line"><span class="lineno">   10</span>            <span class="stringliteral">&quot;Clutch_Feedback&quot;</span>: data[<span class="stringliteral">&quot;ClutchValue&quot;</span>],</div>
<div class="line"><span class="lineno">   11</span>            <span class="stringliteral">&quot;Rotary_Feedback&quot;</span>: data[<span class="stringliteral">&quot;RotaryPosition&quot;</span>],</div>
<div class="line"><span class="lineno">   12</span>        })</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
